µ
9F:\ProText\DistinguishOcr\DistinguishOcr\Common\Class1.cs
	namespace 	
DistinguishOcr
 
. 
Common 
{ 
class		 	
Class1		
 
{

 
private 
string 
sss 
= 
$str 
;  
private 
object 
s 
; 
public 
void 
ssssd 
( 
) 
{ 	
} 	
public 
string 
vs 
( 
) 
{ 	
return 
$str 
; 
} 	
} 
class   	
Class2  
 
{!! 
public$$ 
void$$ 
push$$ 
($$ 
)$$ 
{%% 	
push&& 
(&& 
)&& 
;&& 
}'' 	
})) 
}++ ´
DF:\ProText\DistinguishOcr\DistinguishOcr\Common\DistinguishConfig.cs
	namespace 	
DistinguishOcr
 
. 
Common 
{		 
class

 	
DistinguishConfig


 
{ 
public 
string 
inipath 
; 
[ 	
	DllImport	 
( 
$str 
) 
] 
private 
static 
extern 
long "%
WritePrivateProfileString# <
(< =
string= C
sectionD K
,K L
stringM S
keyT W
,W X
stringY _
val` c
,c d
stringe k
filePathl t
)t u
;u v
[ 	
	DllImport	 
( 
$str 
) 
] 
private 
static 
extern 
int !#
GetPrivateProfileString" 9
(9 :
string: @
sectionA H
,H I
stringJ P
keyQ T
,T U
stringV \
def] `
,` a
StringBuilderb o
retValp v
,v w
intx {
size	| Ä
,
Ä Å
string
Ç à
filePath
â ë
)
ë í
;
í ì
public 
DistinguishConfig  
(  !
string! '
INIPath( /
)/ 0
{ 	
inipath   
=   
INIPath   
;   
}!! 	
public++ 
void++ 
IniWriteValue++ !
(++! "
string++" (
Section++) 0
,++0 1
string++2 8
Key++9 <
,++< =
string++> D
Value++E J
)++J K
{,, 	%
WritePrivateProfileString-- %
(--% &
Section--& -
,--- .
Key--/ 2
,--2 3
Value--4 9
,--9 :
this--; ?
.--? @
inipath--@ G
)--G H
;--H I
}.. 	
public44 
string44 
IniReadValue44 "
(44" #
string44# )
Section44* 1
,441 2
string443 9
Key44: =
)44= >
{55 	
StringBuilder66 
temp66 
=66  
new66! $
StringBuilder66% 2
(662 3
$num663 6
)666 7
;667 8
int77 
i77 
=77 #
GetPrivateProfileString77 +
(77+ ,
Section77, 3
,773 4
Key775 8
,778 9
$str77: <
,77< =
temp77> B
,77B C
$num77D G
,77G H
this77I M
.77M N
inipath77N U
)77U V
;77V W
return88 
temp88 
.88 
ToString88  
(88  !
)88! "
;88" #
}99 	
public>> 
bool>> 
ExistINIFile>>  
(>>  !
)>>! "
{?? 	
return@@ 
File@@ 
.@@ 
Exists@@ 
(@@ 
inipath@@ &
)@@& '
;@@' (
}AA 	
}BB 
}CC  [
>F:\ProText\DistinguishOcr\DistinguishOcr\Common\CommonClass.cs
	namespace		 	
DistinguishOcr		
 
.		 
Common		 
{

 
public 

static 
class 
CommonClass #
{ 
private 
static 
Baidu 
. 
Aip  
.  !
Ocr! $
.$ %
Ocr% (

_OcrClient) 3
=4 5
null6 :
;: ;
private 
static 
string 
_LogPath &
=' (
null) -
;- .
private 
static 
string 
_ConfigPath )
=* +
null, 0
;0 1
public 
static 
string 
API_KEY $
{ 	
get 
{ 
DistinguishConfig !
config" (
=) *
new+ .
DistinguishConfig/ @
(@ A

ConfigPathA K
)K L
;L M
string 
api_key 
=  
config! '
.' (
IniReadValue( 4
(4 5
$str5 @
,@ A
$strB K
)K L
;L M
return 
api_key 
; 
} 
set 
{   
DistinguishConfig!! !
config!!" (
=!!) *
new!!+ .
DistinguishConfig!!/ @
(!!@ A

ConfigPath!!A K
)!!K L
;!!L M
config"" 
."" 
IniWriteValue"" $
(""$ %
$str""% 0
,""0 1
$str""2 ;
,""; <
value""= B
)""B C
;""C D
}## 
}$$ 	
public&& 
static&& 
string&& 

SECRET_KEY&& '
{'' 	
get(( 
{)) 
DistinguishConfig** !
config**" (
=**) *
new**+ .
DistinguishConfig**/ @
(**@ A

ConfigPath**A K
)**K L
;**L M
string++ 

secret_key++ !
=++" #
config++$ *
.++* +
IniReadValue+++ 7
(++7 8
$str++8 C
,++C D
$str++E Q
)++Q R
;++R S
return,, 

secret_key,, !
;,,! "
}-- 
set.. 
{// 
DistinguishConfig00 !
config00" (
=00) *
new00+ .
DistinguishConfig00/ @
(00@ A

ConfigPath00A K
)00K L
;00L M
config11 
.11 
IniWriteValue11 $
(11$ %
$str11% 0
,110 1
$str112 >
,11> ?
value11@ E
)11E F
;11F G
}22 
}33 	
public55 
static55 
Baidu55 
.55 
Aip55 
.55  
Ocr55  #
.55# $
Ocr55$ '
	OcrClient55( 1
{66 	
get77 
{88 

_OcrClient99 
=99 
new99  
Baidu99! &
.99& '
Aip99' *
.99* +
Ocr99+ .
.99. /
Ocr99/ 2
(992 3
API_KEY993 :
,99: ;

SECRET_KEY99< F
)99F G
{:: 
Timeout;; 
=;; 
$num;; #
}<< 
;<< 
return>> 

_OcrClient>> !
;>>! "
}?? 
}@@ 	
publicCC 
staticCC 
stringCC 
LogPathCC $
{DD 	
getEE 
{FF 
ifGG 
(GG 
stringGG 
.GG 
IsNullOrEmptyGG (
(GG( )
_LogPathGG) 1
)GG1 2
)GG2 3
{HH 
_LogPathII 
=II 
	AppDomainII (
.II( )
CurrentDomainII) 6
.II6 7
BaseDirectoryII7 D
+IIE F
$strIIG R
+IIS T
DateTimeIIU ]
.II] ^
NowII^ a
.IIa b
ToStringIIb j
(IIj k
$strIIk u
)IIu v
+IIw x
$strIIy 
;	II Ä
}JJ 
returnKK 
_LogPathKK 
;KK  
}LL 
}NN 	
publicQQ 
staticQQ 
stringQQ 

ConfigPathQQ '
{RR 	
getSS 
{TT 
ifUU 
(UU 
stringUU 
.UU 
IsNullOrEmptyUU (
(UU( )
_ConfigPathUU) 4
)UU4 5
)UU5 6
{VV 
_ConfigPathWW 
=WW  !
ApplicationWW" -
.WW- .
StartupPathWW. 9
+WW: ;
$strWW< U
;WWU V
}XX 
returnYY 
_ConfigPathYY "
;YY" #
}ZZ 
}[[ 	
public]] 
enum]] 
Message]] 
{^^ 	
error__ 
,__ 
success`` 
}aa 	
publicff 
staticff 
stringff 
WriteLogff %
(ff% &
stringff& ,
textff- 1
)ff1 2
{gg 	
stringhh 
messagehh 
=hh 
$strhh 
;hh  
stringkk 
logDirectoryPathkk #
=kk$ %
Pathkk& *
.kk* +
GetDirectoryNamekk+ ;
(kk; <
Commonkk< B
.kkB C
CommonClasskkC N
.kkN O
LogPathkkO V
)kkV W
;kkW X
ifmm 
(mm 
!mm 
	Directorymm 
.mm 
Existsmm !
(mm! "
logDirectoryPathmm" 2
)mm2 3
)mm3 4
{mm5 6
	Directorymm7 @
.mm@ A
CreateDirectorymmA P
(mmP Q
logDirectoryPathmmQ a
)mma b
;mmb c
}mmd e
Systemoo 
.oo 
IOoo 
.oo 

FileStreamoo  
sfileoo! &
=oo' (
newoo) ,
Systemoo- 3
.oo3 4
IOoo4 6
.oo6 7

FileStreamoo7 A
(ooA B
CommonooB H
.ooH I
CommonClassooI T
.ooT U
LogPathooU \
,oo\ ]
FileModeoo^ f
.oof g
Appendoog m
,oom n

FileAccessooo y
.ooy z
Writeooz 
)	oo Ä
;
ooÄ Å
StreamWriterpp 
myfilepp 
=pp  !
newpp" %
StreamWriterpp& 2
(pp2 3
sfilepp3 8
)pp8 9
;pp9 :
tryqq 
{rr 
myfiless 
.ss 
	WriteLiness  
(ss  !
textss! %
)ss% &
;ss& '
myfilett 
.tt 
Flushtt 
(tt 
)tt 
;tt 
myfileuu 
.uu 
Closeuu 
(uu 
)uu 
;uu 
sfilevv 
.vv 
Closevv 
(vv 
)vv 
;vv 
}ww 
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx  
{yy 
ifzz 
(zz 
myfilezz 
!=zz 
nullzz "
)zz" #
{{{ 
myfile|| 
.|| 
Flush||  
(||  !
)||! "
;||" #
myfile}} 
.}} 
Close}}  
(}}  !
)}}! "
;}}" #
}~~ 
if 
( 
sfile 
!= 
null !
)! "
{
ÄÄ 
sfile
ÅÅ 
.
ÅÅ 
Close
ÅÅ 
(
ÅÅ  
)
ÅÅ  !
;
ÅÅ! "
}
ÇÇ 
message
ÉÉ 
+=
ÉÉ 
ex
ÉÉ 
.
ÉÉ 
Source
ÉÉ $
+
ÉÉ% &
ex
ÉÉ' )
.
ÉÉ) *
Message
ÉÉ* 1
;
ÉÉ1 2
}
ÑÑ 
return
ÖÖ 
message
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
public
áá 
static
áá 
string
áá 
WriteLog
áá %
(
áá% &
List
áá& *
<
áá* +
string
áá+ 1
>
áá1 2
l_text
áá3 9
)
áá9 :
{
àà 	
string
ââ 
message
ââ 
=
ââ 
$str
ââ 
;
ââ  
string
ãã 
logDirectoryPath
ãã #
=
ãã$ %
Path
ãã& *
.
ãã* +
GetDirectoryName
ãã+ ;
(
ãã; <
Common
ãã< B
.
ããB C
CommonClass
ããC N
.
ããN O
LogPath
ããO V
)
ããV W
;
ããW X
if
çç 
(
çç 
!
çç 
	Directory
çç 
.
çç 
Exists
çç !
(
çç! "
logDirectoryPath
çç" 2
)
çç2 3
)
çç3 4
{
çç5 6
	Directory
çç7 @
.
çç@ A
CreateDirectory
ççA P
(
ççP Q
logDirectoryPath
ççQ a
)
çça b
;
ççb c
}
ççd e
System
èè 
.
èè 
IO
èè 
.
èè 

FileStream
èè  
sfile
èè! &
=
èè' (
new
èè) ,
System
èè- 3
.
èè3 4
IO
èè4 6
.
èè6 7

FileStream
èè7 A
(
èèA B
Common
èèB H
.
èèH I
CommonClass
èèI T
.
èèT U
LogPath
èèU \
,
èè\ ]
FileMode
èè^ f
.
èèf g
Append
èèg m
,
èèm n

FileAccess
èèo y
.
èèy z
Write
èèz 
)èè Ä
;èèÄ Å
StreamWriter
êê 
myfile
êê 
=
êê  !
new
êê" %
StreamWriter
êê& 2
(
êê2 3
sfile
êê3 8
)
êê8 9
;
êê9 :
try
ëë 
{
íí 
for
ìì 
(
ìì 
int
ìì 
i
ìì 
=
ìì 
$num
ìì 
;
ìì 
i
ìì  !
<
ìì" #
l_text
ìì$ *
.
ìì* +
Count
ìì+ 0
;
ìì0 1
i
ìì2 3
++
ìì3 5
)
ìì5 6
{
îî 
myfile
ïï 
.
ïï 
	WriteLine
ïï $
(
ïï$ %
l_text
ïï% +
[
ïï+ ,
i
ïï, -
]
ïï- .
)
ïï. /
;
ïï/ 0
}
ññ 
myfile
óó 
.
óó 
Flush
óó 
(
óó 
)
óó 
;
óó 
myfile
òò 
.
òò 
Close
òò 
(
òò 
)
òò 
;
òò 
sfile
ôô 
.
ôô 
Close
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
úú 
if
ùù 
(
ùù 
myfile
ùù 
!=
ùù 
null
ùù "
)
ùù" #
{
ûû 
myfile
üü 
.
üü 
Flush
üü  
(
üü  !
)
üü! "
;
üü" #
myfile
†† 
.
†† 
Close
††  
(
††  !
)
††! "
;
††" #
}
°° 
if
¢¢ 
(
¢¢ 
sfile
¢¢ 
!=
¢¢ 
null
¢¢ !
)
¢¢! "
{
££ 
sfile
§§ 
.
§§ 
Close
§§ 
(
§§  
)
§§  !
;
§§! "
}
•• 
message
¶¶ 
+=
¶¶ 
ex
¶¶ 
.
¶¶ 
Source
¶¶ $
+
¶¶% &
ex
¶¶' )
.
¶¶) *
Message
¶¶* 1
;
¶¶1 2
}
ßß 
return
®® 
message
®® 
;
®® 
}
©© 	
}
´´ 
}¨¨ º/
4F:\ProText\DistinguishOcr\DistinguishOcr\FormBase.cs
	namespace 	
DistinguishOcr
 
{ 
public 

partial 
class 
FormBase !
:" #
Form$ (
{ 
public 
FormBase 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 

Form1_Load 
(  
object  &
sender' -
,- .
	EventArgs/ 8
e9 :
): ;
{ 	
this 
. 

labelTitle 
. 
Text  
=! "
$str# )
;) *
this 
. 
	PanelBase 
. 
Controls #
.# $
Clear$ )
() *
)* +
;+ ,
this 
. 
	PanelBase 
. 
Controls #
.# $
Add$ '
(' (
new( +
UserControlInvoice, >
(> ?
)? @
{A B
WidthC H
=I J
thisK O
.O P
	PanelBaseP Y
.Y Z
WidthZ _
,_ `
Heighta g
=h i
thisj n
.n o
	PanelBaseo x
.x y
Heighty 
}
Ä Å
)
Å Ç
;
Ç É
} 	
private%% 
void%% +
ToolStripMenuItem_Invoice_Click%% 4
(%%4 5
object%%5 ;
sender%%< B
,%%B C
	EventArgs%%D M
e%%N O
)%%O P
{&& 	
this'' 
.'' 

labelTitle'' 
.'' 
Text''  
=''! "
sender''# )
.'') *
ToString''* 2
(''2 3
)''3 4
;''4 5
if)) 
()) 
!)) 
this)) 
.)) 
	PanelBase)) 
.))  
Controls))  (
.))( )
ContainsKey))) 4
())4 5
$str))5 I
)))I J
)))J K
{** 
this++ 
.++ 
	PanelBase++ 
.++ 
Controls++ '
.++' (
Clear++( -
(++- .
)++. /
;++/ 0
this,, 
.,, 
	PanelBase,, 
.,, 
Controls,, '
.,,' (
Add,,( +
(,,+ ,
new,,, /
UserControlInvoice,,0 B
(,,B C
),,C D
{,,E F
Width,,G L
=,,M N
this,,O S
.,,S T
	PanelBase,,T ]
.,,] ^
Width,,^ c
,,,c d
Height,,e k
=,,l m
this,,n r
.,,r s
	PanelBase,,s |
.,,| }
Height	,,} É
}
,,Ñ Ö
)
,,Ö Ü
;
,,Ü á
}-- 
}.. 	
private00 
void00 (
ToolStripMenuItem_File_Click00 1
(001 2
object002 8
sender009 ?
,00? @
	EventArgs00A J
e00K L
)00L M
{11 	
this22 
.22 

labelTitle22 
.22 
Text22  
=22! "
sender22# )
.22) *
ToString22* 2
(222 3
)223 4
;224 5
if44 
(44 
!44 
this44 
.44 
	PanelBase44 
.44  
Controls44  (
.44( )
ContainsKey44) 4
(444 5
$str445 F
)44F G
)44G H
{55 
this66 
.66 
	PanelBase66 
.66 
Controls66 '
.66' (
Clear66( -
(66- .
)66. /
;66/ 0
this77 
.77 
	PanelBase77 
.77 
Controls77 '
.77' (
Add77( +
(77+ ,
new77, /
UserControlFile770 ?
(77? @
)77@ A
{77B C
Width77D I
=77J K
this77L P
.77P Q
	PanelBase77Q Z
.77Z [
Width77[ `
,77` a
Height77b h
=77i j
this77k o
.77o p
	PanelBase77p y
.77y z
Height	77z Ä
}
77Å Ç
)
77Ç É
;
77É Ñ
}88 
}99 	
private<< 
void<< '
ToolStripMenuItem_Log_Click<< 0
(<<0 1
object<<1 7
sender<<8 >
,<<> ?
	EventArgs<<@ I
e<<J K
)<<K L
{== 	
}@@ 	
privateBB 
voidBB ,
 ToolStripMenuItem_Register_ClickBB 5
(BB5 6
objectBB6 <
senderBB= C
,BBC D
	EventArgsBBE N
eBBO P
)BBP Q
{CC 	
thisDD 
.DD 

labelTitleDD 
.DD 
TextDD  
=DD! "
senderDD# )
.DD) *
ToStringDD* 2
(DD2 3
)DD3 4
;DD4 5
ifFF 
(FF 
!FF 
thisFF 
.FF 
	PanelBaseFF 
.FF  
ControlsFF  (
.FF( )
ContainsKeyFF) 4
(FF4 5
$strFF5 J
)FFJ K
)FFK L
{GG 
thisHH 
.HH 
	PanelBaseHH 
.HH 
ControlsHH '
.HH' (
ClearHH( -
(HH- .
)HH. /
;HH/ 0
thisII 
.II 
	PanelBaseII 
.II 
ControlsII '
.II' (
AddII( +
(II+ ,
newII, /
UserControlRegisterII0 C
(IIC D
)IID E
{IIF G
WidthIIH M
=IIN O
thisIIP T
.IIT U
	PanelBaseIIU ^
.II^ _
WidthII_ d
,IId e
HeightIIf l
=IIm n
thisIIo s
.IIs t
	PanelBaseIIt }
.II} ~
Height	II~ Ñ
}
IIÖ Ü
)
IIÜ á
;
IIá à
}JJ 
}KK 	
}MM 
}NN ∫
3F:\ProText\DistinguishOcr\DistinguishOcr\Program.cs
	namespace 	
DistinguishOcr
 
{ 
static 

class 
Program 
{		 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
FormBase  (
(( )
)) *
)* +
;+ ,
} 	
} 
} Ó
CF:\ProText\DistinguishOcr\DistinguishOcr\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str )
)) *
]* +
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str +
)+ ,
], -
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ò5
;F:\ProText\DistinguishOcr\DistinguishOcr\UserControlFile.cs
	namespace 	
DistinguishOcr
 
{ 
public 

partial 
class 
UserControlFile (
:) *
UserControl+ 6
{ 
public 
UserControlFile 
( 
)  
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
BtnChoice_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
OpenFileDialog 
dialog !
=" #
new$ '
OpenFileDialog( 6
(6 7
)7 8
;8 9
dialog 
. 
Multiselect 
=  
false! &
;& '
dialog 
. 
Title 
= 
$str #
;# $
dialog 
. 
Filter 
= 
$str +
;+ ,
if 
( 
dialog 
. 

ShowDialog !
(! "
)" #
==$ &
System' -
.- .
Windows. 5
.5 6
Forms6 ;
.; <
DialogResult< H
.H I
OKI K
)K L
{ 
this 
. 
TextBoxPath  
.  !
Text! %
=& '
dialog( .
.. /
FileName/ 7
;7 8
} 
} 	
private!! 
void!! 
BtnTrans_Click!! #
(!!# $
object!!$ *
sender!!+ 1
,!!1 2
	EventArgs!!3 <
e!!= >
)!!> ?
{"" 	
string$$ 
filePath$$ 
=$$ 
this$$ "
.$$" #
TextBoxPath$$# .
.$$. /
Text$$/ 3
;$$3 4
if&& 
(&& 
string&& 
.&& 
IsNullOrEmpty&& $
(&&$ %
filePath&&% -
)&&- .
)&&. /
{'' 

MessageBox(( 
.(( 
Show(( 
(((  
$str((  +
,((+ ,
$str((- 1
,((1 2
MessageBoxButtons((3 D
.((D E
OK((E G
,((G H
MessageBoxIcon((I W
.((W X
Warning((X _
)((_ `
;((` a
return)) 
;)) 
}** 
if,, 
(,, 
!,, 
File,, 
.,, 
Exists,, 
(,, 
filePath,, %
),,% &
),,& '
{-- 

MessageBox.. 
... 
Show.. 
(..  
$str..  (
,..( )
$str..* .
,... /
MessageBoxButtons..0 A
...A B
OK..B D
,..D E
MessageBoxIcon..F T
...T U
Warning..U \
)..\ ]
;..] ^
return// 
;// 
}00 
try22 
{33 
var44 
image44 
=44 
File44  
.44  !
ReadAllBytes44! -
(44- .
filePath44. 6
)446 7
;447 8

Newtonsoft66 
.66 
Json66 
.66  
Linq66  $
.66$ %
JObject66% ,
vv66- /
;66/ 0
if88 
(88 
RadioHandwriting88 $
.88$ %
Checked88% ,
)88, -
{88. /
vv880 2
=883 4
CommonClass885 @
.88@ A
	OcrClient88A J
.88J K
Handwriting88K V
(88V W
image88W \
)88\ ]
;88] ^
}88_ `
else99 
{99 
vv99 
=99 
CommonClass99 '
.99' (
	OcrClient99( 1
.991 2
GeneralBasic992 >
(99> ?
image99? D
)99D E
;99E F
}99G H
bool;; 
hasErr;; 
=;; 
vv;;  
.;;  !

Properties;;! +
(;;+ ,
);;, -
.;;- .
Any;;. 1
(;;1 2
p;;2 3
=>;;4 6
p;;7 8
.;;8 9
Name;;9 =
==;;> @
$str;;A M
);;M N
;;;N O
if== 
(== 
hasErr== 
)== 
{>> 
PrintMessage??  
(??  !
CommonClass??! ,
.??, -
Message??- 4
.??4 5
error??5 :
,??: ;
filePath??< D
+??E F
$str??G R
+??S T
vv??U W
[??W X
$str??X d
]??d e
.??e f
ToString??f n
(??n o
)??o p
+??q r
$str??s v
+??w x
vv??y {
[??{ |
$str	??| á
]
??á à
.
??à â
ToString
??â ë
(
??ë í
)
??í ì
)
??ì î
;
??î ï
}@@ 
elseAA 
{BB 
varCC 
wordsCC 
=CC 
vvCC  "
[CC" #
$strCC# 1
]CC1 2
;CC2 3
foreachEE 
(EE 
varEE  
lineEE! %
inEE& (
wordsEE) .
)EE. /
{FF 
thisGG 
.GG 
textFileGG %
.GG% &
TextGG& *
+=GG+ -
lineGG. 2
[GG2 3
$strGG3 :
]GG: ;
.GG; <
ToStringGG< D
(GGD E
)GGE F
+GGG H
$strGGI O
;GGO P
}HH 
}II 
PrintMessageTT 
(TT 
CommonClassTT (
.TT( )
MessageTT) 0
.TT0 1
successTT1 8
,TT8 9
filePathTT: B
)TTB C
;TTC D
}UU 
catchVV 
(VV 
	ExceptionVV 
exVV 
)VV  
{WW 
PrintMessageXX 
(XX 
CommonClassXX (
.XX( )
MessageXX) 0
.XX0 1
errorXX1 6
,XX6 7
$strXX8 ?
+XX@ A
exXXB D
.XXD E
MessageXXE L
)XXL M
;XXM N
}YY 
}ZZ 	
private\\ 
void\\ 
PrintMessage\\ !
(\\! "
CommonClass\\" -
.\\- .
Message\\. 5
cMes\\6 :
,\\: ;
string\\< B
message\\C J
)\\J K
{]] 	
Common^^ 
.^^ 
CommonClass^^ 
.^^ 
WriteLog^^ '
(^^' (
cMes^^( ,
+^^- .
$str^^/ 3
+^^4 5
message^^6 =
)^^= >
;^^> ?
}__ 	
}bb 
}cc ŒW
>F:\ProText\DistinguishOcr\DistinguishOcr\UserControlInvoice.cs
	namespace 	
DistinguishOcr
 
{ 
public 

partial 
class 
UserControlInvoice +
:, -
UserControl. 9
{ 
public 
UserControlInvoice !
(! "
)" #
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
FormIoc_Load !
(! "
object" (
sender) /
,/ 0
	EventArgs1 :
e; <
)< =
{ 	
} 	
private 
void 
BtnChoice_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
DistinguishConfig 
config $
=% &
new' *
DistinguishConfig+ <
(< =
Common= C
.C D
CommonClassD O
.O P

ConfigPathP Z
)Z [
;[ \
System!! 
.!! 
Windows!! 
.!! 
Forms!!  
.!!  !
FolderBrowserDialog!!! 4
dialog!!5 ;
=!!< =
new!!> A
System!!B H
.!!H I
Windows!!I P
.!!P Q
Forms!!Q V
.!!V W
FolderBrowserDialog!!W j
(!!j k
)!!k l
;!!l m
dialog"" 
."" 
Description"" 
=""  
$str""! )
;"") *
string$$ 
selectedPath$$ 
=$$  !
config$$" (
.$$( )
IniReadValue$$) 5
($$5 6
$str$$6 <
,$$< =
$str$$> L
)$$L M
;$$M N
if&& 
(&& 
!&& 
string&& 
.&& 
IsNullOrEmpty&& %
(&&% &
selectedPath&&& 2
)&&2 3
&&&&4 6
	Directory&&7 @
.&&@ A
Exists&&A G
(&&G H
selectedPath&&H T
)&&T U
)&&U V
{'' 
dialog(( 
.(( 
SelectedPath(( #
=(($ %
selectedPath((& 2
;((2 3
})) 
if,, 
(,, 
dialog,, 
.,, 

ShowDialog,, !
(,,! "
),," #
==,,$ &
System,,' -
.,,- .
Windows,,. 5
.,,5 6
Forms,,6 ;
.,,; <
DialogResult,,< H
.,,H I
OK,,I K
),,K L
{-- 
this.. 
... 
TextBoxPath..  
...  !
Text..! %
=..& '
dialog..( .
.... /
SelectedPath../ ;
;..; <
config00 
.00 
IniWriteValue00 $
(00$ %
$str00% +
,00+ ,
$str00- ;
,00; <
dialog00= C
.00C D
SelectedPath00D P
)00P Q
;00Q R
}11 
}33 	
private55 
void55 
BtnTrans_Click55 #
(55# $
object55$ *
sender55+ 1
,551 2
	EventArgs553 <
e55= >
)55> ?
{66 	
string88 

folderPath88 
=88 
this88  $
.88$ %
TextBoxPath88% 0
.880 1
Text881 5
;885 6
if:: 
(:: 
string:: 
.:: 
IsNullOrEmpty:: $
(::$ %

folderPath::% /
)::/ 0
)::0 1
{;; 

MessageBox<< 
.<< 
Show<< 
(<<  
$str<<  .
,<<. /
$str<<0 4
,<<4 5
MessageBoxButtons<<6 G
.<<G H
OK<<H J
,<<J K
MessageBoxIcon<<L Z
.<<Z [
Warning<<[ b
)<<b c
;<<c d
return== 
;== 
}>> 
if@@ 
(@@ 
!@@ 
	Directory@@ 
.@@ 
Exists@@ !
(@@! "

folderPath@@" ,
)@@, -
)@@- .
{AA 

MessageBoxBB 
.BB 
ShowBB 
(BB  
$strBB  *
,BB* +
$strBB, 0
,BB0 1
MessageBoxButtonsBB2 C
.BBC D
OKBBD F
,BBF G
MessageBoxIconBBH V
.BBV W
WarningBBW ^
)BB^ _
;BB_ `
returnCC 
;CC 
}DD 
tryEE 
{FF 
DirectoryInfoGG 
directoryInfoGG +
=GG, -
newGG. 1
DirectoryInfoGG2 ?
(GG? @

folderPathGG@ J
)GGJ K
;GGK L
ListII 
<II 
stringII 
>II 

lExtensionII '
=II( )
newII* -
ListII. 2
<II2 3
stringII3 9
>II9 :
(II: ;
)II; <
{II= >
$strII? E
,IIE F
$strIIG M
,IIM N
$strIIO V
,IIV W
$strIIX ^
}II_ `
;II` a
FileInfoKK 
[KK 
]KK 
filesKK  
=KK! "
directoryInfoKK# 0
.KK0 1
GetFilesKK1 9
(KK9 :
$strKK: ?
,KK? @
SearchOptionKKA M
.KKM N
TopDirectoryOnlyKKN ^
)KK^ _
.KK_ `
WhereKK` e
(KKe f
tKKf g
=>KKh j

lExtensionKKk u
.KKu v
ContainsKKv ~
(KK~ 
t	KK Ä
.
KKÄ Å
	Extension
KKÅ ä
.
KKä ã
ToLower
KKã í
(
KKí ì
)
KKì î
)
KKî ï
)
KKï ñ
.
KKñ ó
ToArray
KKó û
(
KKû ü
)
KKü †
;
KK† °
forMM 
(MM 
intMM 
iMM 
=MM 
$numMM 
;MM 
iMM  !
<MM" #
filesMM$ )
.MM) *
LengthMM* 0
;MM0 1
iMM2 3
++MM3 5
)MM5 6
{NN 
ApplicationOO 
.OO  
DoEventsOO  (
(OO( )
)OO) *
;OO* +
varRR 
imageRR 
=RR 
FileRR  $
.RR$ %
ReadAllBytesRR% 1
(RR1 2
filesRR2 7
[RR7 8
iRR8 9
]RR9 :
.RR: ;
FullNameRR; C
)RRC D
;RRD E
varUU 
vvUU 
=UU 
CommonUU #
.UU# $
CommonClassUU$ /
.UU/ 0
	OcrClientUU0 9
.UU9 :

VatInvoiceUU: D
(UUD E
imageUUE J
)UUJ K
;UUK L
boolWW 
hasErrWW 
=WW  !
vvWW" $
.WW$ %

PropertiesWW% /
(WW/ 0
)WW0 1
.WW1 2
AnyWW2 5
(WW5 6
pWW6 7
=>WW8 :
pWW; <
.WW< =
NameWW= A
==WWB D
$strWWE Q
)WWQ R
;WWR S
ifYY 
(YY 
hasErrYY 
)YY 
{ZZ 
PrintMessage[[ $
([[$ %
CommonClass[[% 0
.[[0 1
Message[[1 8
.[[8 9
error[[9 >
,[[> ?
files[[@ E
[[[E F
i[[F G
][[G H
.[[H I
FullName[[I Q
+[[R S
$str[[T _
+[[` a
vv[[b d
[[[d e
$str[[e q
][[q r
.[[r s
ToString[[s {
([[{ |
)[[| }
+[[~ 
$str
[[Ä É
+
[[Ñ Ö
vv
[[Ü à
[
[[à â
$str
[[â î
]
[[î ï
.
[[ï ñ
ToString
[[ñ û
(
[[û ü
)
[[ü †
)
[[† °
;
[[° ¢
}\\ 
else]] 
{^^ 
string__ 

invoiceNum__ )
=__* +
vv__, .
[__. /
$str__/ =
]__= >
[__> ?
$str__? K
]__K L
.__L M
ToString__M U
(__U V
)__V W
;__W X
stringbb 
newFileNamebb *
=bb+ ,

invoiceNumbb- 7
+bb8 9
Pathbb: >
.bb> ?
GetExtensionbb? K
(bbK L
filesbbL Q
[bbQ R
ibbR S
]bbS T
.bbT U
FullNamebbU ]
)bb] ^
;bb^ _
ifdd 
(dd 

invoiceNumdd &
!=dd' )
Pathdd* .
.dd. /'
GetFileNameWithoutExtensiondd/ J
(ddJ K
filesddK P
[ddP Q
iddQ R
]ddR S
.ddS T
FullNameddT \
)dd\ ]
)dd] ^
{ee 
Computerff $

MyComputerff% /
=ff0 1
newff2 5
Computerff6 >
(ff> ?
)ff? @
;ff@ A

MyComputergg &
.gg& '

FileSystemgg' 1
.gg1 2

RenameFilegg2 <
(gg< =
filesgg= B
[ggB C
iggC D
]ggD E
.ggE F
FullNameggF N
,ggN O
newFileNameggP [
)gg[ \
;gg\ ]
}hh 
PrintMessagejj $
(jj$ %
CommonClassjj% 0
.jj0 1
Messagejj1 8
.jj8 9
successjj9 @
,jj@ A

invoiceNumjjB L
+jjM N
$strjjO U
+jjV W
filesjjX ]
[jj] ^
ijj^ _
]jj_ `
.jj` a
FullNamejja i
)jji j
;jjj k
}kk 
}ll 
}mm 
catchnn 
(nn 
	Exceptionnn 
exnn 
)nn  
{oo 
PrintMessagepp 
(pp 
CommonClasspp (
.pp( )
Messagepp) 0
.pp0 1
errorpp1 6
,pp6 7
$strpp8 ?
+pp@ A
exppB D
.ppD E
MessageppE L
)ppL M
;ppM N
}qq 
PrintMessagess 
(ss 
CommonClassss $
.ss$ %
Messagess% ,
.ss, -
successss- 4
,ss4 5
$strss6 <
)ss< =
;ss= >
}uu 	
privateww 
voidww 
PrintMessageww !
(ww! "
CommonClassww" -
.ww- .
Messageww. 5
cMesww6 :
,ww: ;
stringww< B
messagewwC J
)wwJ K
{xx 	
Commonyy 
.yy 
CommonClassyy 
.yy 
WriteLogyy '
(yy' (
cMesyy( ,
+yy- .
$stryy/ 3
+yy4 5
messageyy6 =
)yy= >
;yy> ?
this{{ 
.{{ 
ListMessageBox{{ 
.{{  
Items{{  %
.{{% &
Add{{& )
({{) *
cMes{{* .
+{{/ 0
$str{{1 5
+{{6 7
message{{8 ?
){{? @
;{{@ A
this}} 
.}} 
ListMessageBox}} 
.}}  
SelectedIndex}}  -
=}}. /
this}}0 4
.}}4 5
ListMessageBox}}5 C
.}}C D
Items}}D I
.}}I J
Count}}J O
-}}P Q
$num}}R S
;}}S T
} 	
}
êê 
}ëë ¬
?F:\ProText\DistinguishOcr\DistinguishOcr\UserControlRegister.cs
	namespace

 	
DistinguishOcr


 
{ 
public 

partial 
class 
UserControlRegister ,
:- .
UserControl/ :
{ 
public 
UserControlRegister "
(" #
)# $
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
BtnSure_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
Common 
. 
CommonClass 
. 
API_KEY &
=' (
this) -
.- .
textBox_api_key. =
.= >
Text> B
;B C
Common 
. 
CommonClass 
. 

SECRET_KEY )
=* +
this, 0
.0 1
textBox_secret_key1 C
.C D
TextD H
;H I

MessageBox 
. 
Show 
( 
$str #
,# $
$str% )
,) *
MessageBoxButtons+ <
.< =
OK= ?
,? @
MessageBoxIconA O
.O P
InformationP [
)[ \
;\ ]
} 	
} 
} 